<!-- <!-- <!DOCTYPE html> -->
<html lang="en">

    <head>
        <meta charset="utf-8">
        <title>Fruitables - Vegetable Website Template</title>
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta content="" name="keywords">
        <meta content="" name="description">

        <!-- Google Web Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Raleway:wght@600;800&display=swap" rel="stylesheet"> 

        <!-- Icon Font Stylesheet -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"/>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

        <!-- Libraries Stylesheet -->
        <link href="User/lib/lightbox/css/lightbox.min.css" rel="stylesheet">
        <link href="User/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">


        <!-- Customized Bootstrap Stylesheet -->
        <link href="User/css/bootstrap.min.css" rel="stylesheet">

        <!-- Template Stylesheet -->
        <link href="User/css/style.css" rel="stylesheet">
       <style>
        /* General Styles for the Account Dashboard Section */
.account-dashboard {
    background-color: #f9f9f9;
    padding: 40px 0;
    font-family: 'Open Sans', sans-serif;
}

.dashboard_tab_button {
    background-color: #ffffff;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    padding: 15px;
    border-radius: 8px;
}

.dashboard-list .nav-link {
    font-size: 16px;
    font-weight: 600;
    color: #555;
    border: none;
    margin-bottom: 10px;
    border-radius: 6px;
    text-align: left;
    transition: all 0.3s ease-in-out;
}

.dashboard-list .nav-link:hover,
.dashboard-list .nav-link.active {
    background-color: #81C408;
    color: #fff;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
}

.dashboard_content {
    background-color: #ffffff;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    padding: 20px;
    border-radius: 8px;
}

h4 {
    font-size: 22px;
    color: #333;
    margin-bottom: 20px;
    font-weight: bold;
}

.personal-details-content p,
.address-section address p {
    font-size: 16px;
    color: #666;
    margin-bottom: 8px;
    line-height: 1.5;
}

/* Address Section Styles */
.address-section h5 {
    font-size: 18px;
    color: #333;
    margin-bottom: 12px;
    font-weight: bold;
}

.address-section address {
    background-color: #f5f5f5;
    padding: 15px;
    border-radius: 6px;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
}

.save_button {
    margin-top: 15px;
}

.save_button .btn {
    font-size: 14px;
    background-color: #81C408;
    color: #fff;
    border-radius: 6px;
    padding: 8px 16px;
    transition: all 0.3s;
}

.save_button .btn:hover {
    background-color: #6fa306;
}

/* Orders Tab Styles */
.table_page {
    margin-top: 20px;
}

.table_page table {
    width: 100%;
    border-collapse: collapse;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
}

.table_page th,
.table_page td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid #eaeaea;
    font-size: 15px;
    color: #333;
}

.table_page th {
    background-color: #f7f7f7;
    font-weight: bold;
    color: #555;
}

.table_page tbody tr:hover {
    background-color: #f1f1f1;
}

.table_page .view {
    color: #81C408;
    font-weight: 600;
    text-decoration: none;
    transition: color 0.3s ease-in-out;
}

.table_page .view:hover {
    color: #6fa306;
}

/* Change Password Tab Styles */
.account_login_form label {
    font-size: 15px;
    color: #333;
    font-weight: 600;
    margin-bottom: 8px;
}

.account_login_form input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
    margin-bottom: 15px;
}

.account_login_form .btn {
    background-color: #81C408;
    color: #fff;
    padding: 10px 20px;
    font-size: 15px;
    border-radius: 6px;
    transition: background-color 0.3s ease-in-out;
}

.account_login_form .btn:hover {
    background-color: #6fa306;
}
.personal-details-content table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

.personal-details-content th,
.personal-details-content td {
    padding: 12px;
    text-align: left;
    font-size: 16px;
    color: #555;
}

.personal-details-content th {
    background-color: #f7f7f7;
    font-weight: bold;
}

.save_button {
    text-align: right;
}
.user-profile {
    border: 1px solid #dcdcdc;
    padding: 15px;
    border-radius: 8px;
    background-color: #fff; /* White background for contrast */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

.user-profile h5 {
    margin: 10px 0 5px;
    font-size: 18px; /* Slightly larger font for the name */
}

.user-profile p {
    font-size: 14px; /* Smaller font for the email */
    color: #777; /* Gray color for email */
}
/* Style to make the modal full-height and adjust for padding */
.modal-dialog {
    max-width: 800px; /* Set max-width for the modal */
    width: 100%; /* Ensure it takes the full available width */
    margin: 1.75rem auto; /* Center the modal vertically */
}

.modal-content {
    height: 90vh; /* Set height to fill 90% of the viewport height */
    overflow-y: auto; /* Enable scrolling inside the modal if content overflows */
    padding: 20px; /* Add some padding inside the modal */
}

.modal-header, .modal-footer {
    background-color: #f8f9fa; /* Optional: Set background color for header and footer */
    border-bottom: none; /* Remove border from header */
    border-top: none; /* Remove border from footer */
}

.modal-body {
    padding: 20px; /* Add padding to the body */
}

.form-control {
    margin-bottom: 10px; /* Add space between form inputs */
}
.modal-lg {
  max-width: 50%; /* Ensures the modal takes up 90% of the screen width */
}

.form-group label {
  font-weight: bold; /* Emphasize labels */
}

.form-group input,
.form-group textarea {
  width: 100%; /* Ensure all form fields take up the full width of the column */
  padding: 10px;
  margin-bottom: 15px;
}

.form-check-inline {
  margin-right: 20px; /* Adds spacing between address type options */
}


       </style> 

<!-- oders styles -->
<style>
/* Ensure the icons are aligned and styled properly */
.table_page a.view, .table_page a.cancel {
    display: inline-block;
    font-size: 1.2rem; /* Adjust the size of the icons */
    color: #fff;
    padding: 6px;
    border-radius: 4px; /* Optional: Add rounded corners */
}

/* Optional hover effect */
.table_page a.view:hover, .table_page a.cancel:hover {
    opacity: 0.8; /* Slight transparency on hover */
}

</style>
    </head>

    <body>

        <!-- Spinner Start -->
        <!-- <div id="spinner" class="show w-100 vh-100 bg-white position-fixed translate-middle top-50 start-50  d-flex align-items-center justify-content-center">
            <div class="spinner-grow text-primary" role="status"></div>
        </div> -->
        <!-- Spinner End -->


        <!-- Navbar start -->
        <%- include('partials/header') %>
        <!-- Navbar End -->


        <!-- Modal Search Start -->
        <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content rounded-0">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Search by keyword</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body d-flex align-items-center">
                        <div class="input-group w-75 mx-auto d-flex">
                            <input type="search" class="form-control p-3" placeholder="keywords" aria-describedby="search-icon-1">
                            <span id="search-icon-1" class="input-group-text p-3"><i class="fa fa-search"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>






<!-- ...:::: Start Account Dashboard Section:::... -->
<div class="account-dashboard">
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-3 col-lg-3">
                <!-- user profile section -->
                <div class="user-profile text-center mb-4">
                    <i class="fas fa-user-circle" style="font-size: 50px; color: #81C408;"></i>
                    <h5 class="mt-2"><%= userDetails.username %></h5>
                    <p class="mb-0"><%= userDetails.email %></p>
                </div>
                <!-- Nav tabs -->
                <div class="dashboard_tab_button" data-aos="fade-up" data-aos-delay="0">
                    <ul role="tablist" class="nav flex-column dashboard-list">
                        <li><a href="#personal-details" data-bs-toggle="tab"
                                class="nav-link btn btn-block btn-md btn-black-default-hover active">Personal Details</a>
                        </li>
                        <li><a href="#change-password" data-bs-toggle="tab"
                                class="nav-link btn btn-block btn-md btn-black-default-hover">Change Password</a></li>
                        <li><a href="#orders" data-bs-toggle="tab"
                                class="nav-link btn btn-block btn-md btn-black-default-hover">Orders</a></li>
                        <li><a href="#address" data-bs-toggle="tab"
                                class="nav-link btn btn-block btn-md btn-black-default-hover">Addresses</a></li>
                        <li><a href="#wallet" data-bs-toggle="tab"
                                class="nav-link btn btn-block btn-md btn-black-default-hover">My wallet</a></li>       
                    </ul>
                </div>
            </div>
            <div class="col-sm-12 col-md-9 col-lg-9">
                <!-- Tab panes -->
                <div class="tab-content dashboard_content" data-aos="fade-up" data-aos-delay="200">
                    <!-- Personal Details Tab -->
                    <div class="tab-pane fade show active" id="personal-details">
                        <h4><i class="fas fa-user-circle" style="font-size: 40px; color: #81C408;"></i> Personal Details</h4>
                        
                        <!-- View Mode: Display the personal details -->
                        <div id="details-view">
                            <table class="table table-bordered">
                                <tbody>
                                    <tr>
                                        <td><strong>Name:</strong></td>
                                        <!-- Display the user's name dynamically -->
                                        <td><%= userDetails.username %></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Email:</strong></td>
                                        <!-- Display the user's email dynamically -->
                                        <td><%= userDetails.email %></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Mobile:</strong></td>
                                        <!-- Display the user's mobile number dynamically -->
                                        <td><%= userDetails.phone %></td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="save_button mt-3">
                                <a href="#" class="btn btn-md btn-black-default-hover" onclick="toggleEditForm()">Edit</a>
                            </div>
                        </div>
                        
                        <!-- Edit Mode: Display the form for editing personal details -->
                        <div id="details-edit" style="display: none;">
                            <form onsubmit="editDetails(event)">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td><strong>Name:</strong></td>
                                            <td>
                                                <input type="text" id="username" value="<%= userDetails.username %>" class="form-control">
                                                <span class="error-message text-danger" id="detailsName"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>Email:</strong></td>
                                            <td>
                                                <input type="email" id="email" value="<%= userDetails.email %>" class="form-control" readonly>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>Mobile:</strong></td>
                                            <td>
                                                <input type="text" id="phone" class="form-control" value="<%= userDetails.phone %>"  maxlength="10" required>
                                                <span class="error-message text-danger" id="detailsPhone"></span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="save_button mt-3">
                                    <button type="submit" class="btn btn-md btn-black-default-hover">Save</button>
                                    <a style="background-color: rgb(40, 101, 255);" class="btn btn-md " onclick="toggleEditForm()">Cancel</a>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Change Password Tab -->
                    <div class="tab-pane fade" id="change-password">
                        <h4>Change Password</h4>
                        <div class="login_form_container">
                            <div class="account_login_form">
                                <form action="#" onsubmit="changePassword(event)">
                                    <div class="default-form-box mb-20">
                                        <label>Current Password</label>
                                        <input type="password" name="current-password" id="current-password" required>
                                    </div>
                                    <div class="default-form-box mb-20">
                                        <label>New Password (min 6 characters)</label>
                                        <input type="password" name="new-password" id="new-password" required>
                                        <small id="new-password-error" style="color: red; display: none;">Password must be at least 6 characters long</small>
                                    </div>
                                    <div class="default-form-box mb-20">
                                        <label>Confirm New Password</label>
                                        <input type="password" name="confirm-new-password" id="confirm-new-password" required>
                                        <small id="confirm-password-error" style="color: red; display: none;">Passwords do not match</small>
                                    </div>
                                    <div class="save_button mt-3">
                                        <button class="btn btn-md btn-black-default-hover" type="submit">Save</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Orders Tab -->
                    <div class="tab-pane fade" id="orders">
                        <h4>Orders</h4>
                        <div class="table_page table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                        <th>Total</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody">
                                    <% orders.slice(0, 5).forEach(function(order) { %> <!-- Display only 5 orders initially -->
                                    <tr>
                                        <td><%= order.orderId %></td>
                                        <td><%= new Date(order.orderDate).toLocaleDateString() %></td>
                                        <td>
                                            <span 
                                                style="<%= order.status === 'Order placed' ? 'color: #007bff;' : '' %>
                                                       <%= order.status === 'Pending' ? 'color: #ffc107;' : '' %>
                                                       <%= order.status === 'Confirmed' ? 'color: #17a2b8;' : '' %>
                                                       <%= order.status === 'Shipped' ? 'color: #6c757d;' : '' %>
                                                       <%= order.status === 'Out for Delivery' ? 'color: #343a40;' : '' %>
                                                       <%= order.status === 'Delivered' ? 'color: #28a745;' : '' %>
                                                       <%= order.status === 'Cancelled' ? 'color: #dc3545;' : '' %>"
                                            >
                                                <%= order.status %>
                                            </span>
                                        </td>
                                        <td>₹<%= order.totalPrice %> for <%= order.items.filter(item => item.status !== 'Cancelled').length; %> items</td>
                                        <td>
                                            <a href="/orders/<%= order._id %>" class="view btn btn-primary btn-sm">
                                                <i class="fas fa-eye"></i> View
                                            </a>
                                          
                                        </td>
                                    </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        </div>
                        <!-- Show More Button -->
                        <% if (orders.length > 5) { %>
                            <div class="text-center">
                                <a href="/orders" id="showMoreBtn" class="btn border border-secondary rounded-pill px-4 py-2 text-primary" style="display: block; margin: 20px auto;">
                                    <i class="fa fa-plus me-2 text-primary"></i> Show More
                                </a>
                            </div>
                        <% } %>
                    </div>
                    <!-- Addresses Tab -->
                    <div class="tab-pane fade" id="address">
                        <h4>Addresses</h4>
                        <p>The following addresses will be used on the checkout page by default.</p>

                        <!-- Add Address Button -->
                        <div class="add-address-button mb-4">
                            <a id="add-address-btn" data-bs-toggle="modal" data-bs-target="#addAddressModal"
                                class="btn border border-secondary rounded-pill px-4 py-2 text-primary">
                                <i class="fa fa-address me-2 text-primary"></i> Add Address
                            </a>
                        </div>

                        <!-- Address List -->
                        <hr>
                        <div id="address-list">
                            <% addresses.forEach(function(address, index) { %>
                                <div class="address-section">
                                    <h5>Shipping Address <%= index + 1 %></h5>
                                    <address>
                                        <p><strong>Name:</strong> <%= address.name %></p>
                                        <p><strong>Address:</strong> <%= address.address %>, <%= address.locality %>, <%= address.district %>, <%= address.pincode %></p>
                                        <p><strong>Phone:</strong> <%= address.phone %></p>
                                    </address>
                                    <div class="save_button mt-3">
                                        <a class="btn btn-md btn-black-default-hover editAddressBtn" 
                                           data-bs-toggle="modal" data-bs-target="#editAddressModal"
                                           data-id="<%= address._id %>" 
                                           data-name="<%= address.name %>"
                                           data-phone="<%= address.phone %>"
                                           data-address="<%= address.address %>"
                                           data-locality="<%= address.locality %>"
                                           data-district="<%= address.district %>"
                                           data-pincode="<%= address.pincode %>"
                                           data-email="<%= address.email %>"
                                           data-state="<%= address.state %>"
                                           data-country="<%= address.country %>">Edit</a>
                                        <a style="background-color: red;" class="btn btn-md btn-danger deleteAddressBtn" onclick="deleteAddress('<%= address._id %>')">Delete</a>
                                    </div>
                                    <hr>
                                </div>
                            <% }); %>
                        </div>
                    </div>

                    <!-- Wallet Tab -->
                    <div class="tab-pane fade" id="wallet">
                        <h4><i class="fas fa-wallet" style="font-size: 40px; color: #81C408;"></i> My Wallet</h4>
                    
                        <!-- Wallet Balance -->
                        <div class="wallet-balance">
                            <h5>Current Balance: <span style="color: #81C408;">₹<%= wallet.balance.toFixed(2) %></span></h5>
                        </div>
                        <a style="font-weight: 600;" href="/wallet">Add Amount</a>
                    
                        <!-- Transaction History -->
                        <h5>Transaction History</h5>
                        <div class="table_page table-responsive">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Description</th>
                                        <th>Amount</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (transactions && transactions.length > 0) { %>
                                        <% transactions.slice(0, 5).forEach(transaction => { %> <!-- Show only the first 5 transactions -->
                                            <tr>
                                                <td style="color: black; font-weight: 550;"><%= new Date(transaction.date).toLocaleDateString() %></td>
                                                <td style="color: black; font-weight: 550;"><%= transaction.description %></td>
                                                <td style=" font-weight: 600; color: <%= transaction.type === 'credit' ? 'green' : 'red' %>; ">
                                                    <%= transaction.type === 'credit' ? '+' : '-' %>₹<%= Math.abs(transaction.amount).toFixed(2) %>
                                                </td>
                                                <td>
                                                    <span style="font-weight: 700; color: <%= transaction.type === 'credit' ? 'green' : 'red' %>;">
                                                        <%= transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1) %> <!-- Capitalize the first letter -->
                                                    </span>
                                                </td>
                                            </tr>
                                        <% }); %>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="4">No transactions found.</td>
                                        </tr>
                                    <% } %>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Show "See more" button if there are more than 5 transactions -->
                        <% if (transactions && transactions.length > 5) { %>
                            <a href="/wallet">See all transactions</a>
                        <% } %>
                    </div>
                    

                </div>
            </div>
        </div>
    </div>
</div>

 <!-- ...:::: End Account Dashboard Section:::... -->



<!--  -->
<!-- Modal for Adding Address -->
<div class="modal fade" id="addAddressModal" tabindex="-1" aria-labelledby="addAddressModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addAddressModalLabel">Add New Address</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addAddressForm" onsubmit="submitAddressForm(event)">
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="name">Name</label>
                            <input type="text" class="form-control" id="name" name="name" placeholder="Full Name" pattern="[A-Za-z]+" title="Name should contain only characters with no spaces." >
                            <span class="error-message text-danger" id="nameError"></span>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="phone">Phone Number</label>
                            <input type="text" class="form-control" id="addressphone" name="phone" placeholder="Phone Number" >
                            <span class="error-message text-danger" id="phoneError"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="pincode">Pin Code</label>
                            <input type="text" class="form-control" id="pincode" name="pincode" pattern="\d{6}" placeholder="6-digit PIN code" title="PIN code must be 6 digits." >
                            <span class="error-message text-danger" id="pincodeError"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="locality">Locality</label>
                            <input type="text" class="form-control" id="locality" name="locality" placeholder="Locality" >
                            <span class="error-message text-danger" id="localityError"></span>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="landmark">Landmark (Optional)</label>
                            <input type="text" class="form-control" id="landmark" name="landmark" placeholder="Landmark">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-4">
                            <label for="district">District</label>
                            <input type="text" class="form-control" id="district" name="district" placeholder="District" >
                            <span class="error-message text-danger" id="districtError"></span>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="state">State</label>
                            <input type="text" class="form-control" id="state" name="state" placeholder="State" >
                            <span class="error-message text-danger" id="stateError"></span>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="country">Country</label>
                            <input type="text" class="form-control" id="country" name="country" placeholder="Country" >
                            <span class="error-message text-danger" id="countryError"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea class="form-control" id="addressInput" name="address" rows="2" placeholder="Address Line" ></textarea>
                        <span class="error-message text-danger" id="addressError"></span>
                    </div>
                    <div class="form-group">
                        <label>Address Type</label><br>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="addressType" id="home" value="Home" >
                            <label class="form-check-label" for="home">Home</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="addressType" id="office" value="Office">
                            <label class="form-check-label" for="office">Office</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="addressType" id="other" value="Other">
                            <label class="form-check-label" for="other">Other</label>
                        </div>
                        <span class="error-message text-danger" id="addressTypeError"></span>
                    </div>
                    <div class="form-group text-center">
                        <button type="submit" class="btn btn-primary py-3 px-5">Add Address</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Edit Address form modal -->
<!-- Edit Address Modal -->
<div class="modal fade" id="editAddressModal" tabindex="-1" aria-labelledby="editAddressModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editAddressModalLabel">Edit Address</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editAddressForm" onsubmit="submitEditAddressForm(event)">
                    <input type="hidden" id="editAddressId" name="addressId">
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="editName">Name</label>
                            <input type="text" class="form-control" id="editName" name="editName" >
                            <span class="error-message text-danger" id="editNameError"></span>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="editPhone">Phone Number</label>
                            <input type="text" class="form-control" id="editPhone" name="editPhone">
                            <span class="error-message text-danger" id="editPhoneError"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="editLocality">Locality</label>
                            <input type="text" class="form-control" id="editLocality" name="editLocality" >
                            <span class="error-message text-danger" id="editLocalityError"></span>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="editPincode">Pin Code</label>
                            <input type="text" class="form-control" id="editPincode" name="editPincode" >
                            <span class="error-message text-danger" id="editPincodeError"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="editDistrict">District</label>
                            <input type="text" class="form-control" id="editDistrict" name="editDistrict" >
                            <span class="error-message text-danger" id="editDistrictError"></span>
                        </div>
                        <div class="form-group col-md-6">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="editState">State</label>
                            <input type="text" class="form-control" id="editState" name="editState" >
                            <span class="error-message text-danger" id="editStateError"></span>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="editCountry">Country</label>
                            <input type="text" class="form-control" id="editCountry" name="editCountry" >
                            <span class="error-message text-danger" id="editCountryError"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editAddress">Address</label>
                        <textarea class="form-control" id="editAddress" name="editAddress" rows="2" ></textarea>
                        <span class="error-message text-danger" id="editAddressError"></span>
                    </div>
                    <div class="form-group text-center">
                        <button type="submit" class="btn btn-primary py-3 px-5">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
            

            


         <!-- Footer Start -->
         <%- include('partials/foooter') %>
         <!-- Footer End -->
 
         <!-- Copyright Start -->
         <div class="container-fluid copyright bg-dark py-4">
             <div class="container">
                 <div class="row">
                     <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                         <span class="text-light"><a href="#"><i class="fas fa-copyright text-light me-2"></i>Your Site Name</a>, All right reserved.</span>
                     </div>
                     <div class="col-md-6 my-auto text-center text-md-end text-white">
                         <!--/*** This template is free as long as you keep the below author’s credit link/attribution link/backlink. ***/-->
                         <!--/*** If you'd like to use the template without the below author’s credit link/attribution link/backlink, ***/-->
                         <!--/*** you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". ***/-->
                         Designed By <a class="border-bottom" href="https://htmlcodex.com">HTML Codex</a> Distributed By <a class="border-bottom" href="https://themewagon.com">ThemeWagon</a>
                     </div>
                 </div>
             </div>
         </div>
         <!-- Copyright End -->




 <script>
    // Function to populate modal with the clicked address data
    document.querySelectorAll('.editAddressBtn').forEach(button => {
        button.addEventListener('click', function () {
            // Retrieve data-* attributes from the clicked button
            const addressId = this.dataset.id;
            const name = this.dataset.name;
            const phone = this.dataset.phone;
            const address = this.dataset.address;
            const locality = this.dataset.locality;
            const district = this.dataset.district;
            const pincode = this.dataset.pincode;
            const email = this.dataset.email;
            const state = this.dataset.state;
            const country = this.dataset.country;

          
            document.getElementById('editAddressId').value = addressId; // Add this line
            document.getElementById('editName').value = name;
            document.getElementById('editPhone').value = phone;
            document.getElementById('editAddress').value = address;
            document.getElementById('editLocality').value = locality;
            document.getElementById('editDistrict').value = district;
            document.getElementById('editPincode').value = pincode;
           
            document.getElementById('editState').value = state;
            document.getElementById('editCountry').value = country;

           
        });
    });
 </script>

<script>
  function changePassword(event) {
    event.preventDefault();

    
    const currentPassword = document.getElementById('current-password').value;
    const newPassword = document.getElementById('new-password').value;
    const confirmPassword = document.getElementById('confirm-new-password').value;
    

    document.getElementById('new-password-error').style.display = 'none';
    document.getElementById('confirm-password-error').style.display = 'none';

    if (newPassword.length < 6) {
        document.getElementById('new-password-error').style.display = 'block';
        return;
    }

    if (newPassword !== confirmPassword) {
        document.getElementById('confirm-password-error').style.display = 'block';
        return;
    }

    // Confirmation before submitting
    Swal.fire({
        title: 'Are you sure?',
        text: "Do you want to change your password?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, change it!'
    }).then((result) => {
        if (result.isConfirmed) {
            const data = {
                currentPassword,
                newPassword,
                confirmPassword
            };

            axios.post('/profile/changePassword', data)
                .then(response => {
                    // Success message
                    if (response.data.success) {
                       Swal.fire({
                           icon: 'success',
                           title: 'Success!',
                           text: response.data.message || 'Password changed successfully!',
                           showConfirmButton: false,
                           timer: 2000,
                           customClass: {
                               confirmButton: 'btn btn-success' 
                           }
                       }).then(() => {
                         
                           window.location.reload(); 
                       });
                   } else {
                       Swal.fire({
                           icon: 'error',
                           title: 'Oops!',
                           text: response.data.message || 'There was a problem changing your password. Please try again.',
                           showConfirmButton: true,
                           customClass: {
                               confirmButton: 'btn btn-danger' // Add your custom class here
                           }
                       });
                   }
                                       
                })
                .catch(error => {
                    // Error message
                    Swal.fire({
                        icon: 'error',
                        title: 'Error!',
                        text: error.response.data.message || 'There was an error changing your password.',
                        customClass: {
                            confirmButton: 'btn btn-danger' 
                        }
                    });
                });
        }
    });
}
</script>
 
         <!-- Back to Top -->
         <a href="#" class="btn btn-primary border-3 border-primary rounded-circle back-to-top"><i class="fa fa-arrow-up"></i></a>   
 
         
     <!-- JavaScript Libraries -->
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
     <script src="User/lib/easing/easing.min.js"></script>
     <script src="User/lib/waypoints/waypoints.min.js"></script>
     <script src="User/lib/lightbox/js/lightbox.min.js"></script>
     <script src="User/lib/owlcarousel/owl.carousel.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 <!-- <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf/notyf.min.css">
<script src="https://cdn.jsdelivr.net/npm/notyf/notyf.min.js"></script>
 
 
     <!-- Template Javascript -->
     <script src="/User/main.js"></script>
     <script src="/User/profile.js"></script>
     </body>
 
 </html>